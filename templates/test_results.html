
{% extends 'base.html' %}
{% block header %}
  <h1>{% block title %}Results{% endblock %}</h1>
{% endblock %}

{% block content %}

    <!-- The results get posted here -->
    {% if result %}
    <div class="ui two column centered padded grid">

        <!-- summary results -->
        <div class="section">
            <table class="ui very basic collapsing celled table">
                <thead>
                <tr><th colspan='2'>Dates</th>
                </tr></thead>
                <tbody>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    Sex
                                    <div class="sub header"></div>
                                </div>
                            </h4>
                        </td>
                        <td>
                            {{result[0].birth_data.sex}}
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    Gestational Age at Delivery
                                    <div class="sub header"></div>
                                </div>
                            </h4>
                        </td>
                        <td>
                            {{result[0].birth_data.gestation_weeks}}+{{result[0].birth_data.gestation_days}} weeks
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                
                                <div class="content">
                                    Chronological Decimal Age
                                    <div class="sub header">                                
                                    </div>
                                </div>
                            </h4>
                        </td>
                        <td>
                            {{result[0].measurement_dates.chronological_decimal_age}} y
                        </td>
                        <!-- <td class='chronological_decimal_age'>
                            <i class="info green circle icon"></i>
                        </td> -->
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui image header">
                                <div class="content">
                                    Corrected Decimal Age
                                    <div class="sub header"></div>
                                </div>
                            </h4>
                        </td>
                        {% if result[0].measurement_dates.corrected_decimal_age != 'None' %}
                        <td>
                            {{result[0].measurement_dates.corrected_decimal_age}} y
                        </td>
                        <td id='corrected_decimal_age' style="border: 0px !important;">
                            <i class="info green circle icon"></i>
                        </td>
                        {% else %}
                        <td>
                            No correction needed
                        </td>
                        {% endif %}
                        <!-- <td class='chronological_decimal_age'>
                            <i class="info green circle icon"></i>
                        </td> -->
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui image header">
                                <div class="content">
                                    <div class="sub header"></div>
                                    Chronological Calendar Age
                                </div>
                            </h4>
                        </td>
                        <td>
                            {{result[0].measurement_dates.chronological_calendar_age}}
                        </td>
                        <!-- <td class='chronological_decimal_age'>
                            <i class="info green circle icon"></i>
                        </td> -->
                    </tr>
                    <tr>
                        <td>
                        <h4 class="ui image header">
                            
                            <div class="content">
                            Corrected Calendar Age
                            <div class="sub header">
                            </div>
                        </div>
                        </h4></td>
                        {% if result[0].measurement_dates.corrected_calendar_age %}
                        <td>
                            {{result[0].measurement_dates.corrected_calendar_age}}
                        </td>
                        <!-- <td class='chronological_decimal_age'>
                            <i class="info green circle icon"></i>
                        </td> -->
                        {% else %}
                            <td>
                                No correction needed
                            </td>
                        {% endif %}
                    </tr>
                    <tr>
                        <td>
                        <h4 class="ui image header">
                            
                            <div class="content">
                            Estimated Date of Delivery
                            <div class="sub header">
                            </div>
                        </div>
                        </h4></td>
                        {% if result[0].measurement_dates.edd_string %}
                        <td>
                            {{result[0].measurement_dates.edd_string}}
                        </td>
                        <!-- <td class='chronological_decimal_age'>
                            <i class="info green circle icon"></i>
                        </td> -->
                        {% else %}
                            <td>
                                No correction needed
                            </td>
                        {% endif %}
                    </tr>
                    <tr>
                        <td>
                        <h4 class="ui image header">
                            
                            <div class="content">
                            Corrected Gestational Age
                            <div class="sub header">
                            </div>
                        </div>
                        </h4></td>
                        {% if result[0].measurement_dates.corrected_gestational_age %}
                        <td>
                            {{result[0].measurement_dates.corrected_gestational_age}}
                        </td>
                        {% else %}
                            <td>
                                No correction needed
                            </td>
                        {% endif %}
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- measurement results -->

        <div class="section">
            <table class="ui very basic collapsing celled table">
                <thead>
                    <tr>
                        <th colspan='2'>Measurements</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <h4 class="ui blue header">
                                <div class="content">
                                    Height
                                    <div class="sub header">
                                        
                                    </div>
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result %}
                            {% if measurement.child_measurement_value.height is not none %}
                                <td>
                                    {{ measurement.child_measurement_value.height }} cm
                                </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    SDS
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result %}
                            {% if measurement.measurement_calculated_values.height_sds is number %}
                            <td>
                                <div class="ui blue header">
                                    {{ measurement.measurement_calculated_values.height_sds }}
                                </div>
                            </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    Centile
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result %}
                            {% if measurement.measurement_calculated_values.height_centile is number %}
                                <td>
                                    <div class="ui blue header">
                                        {{ measurement.measurement_calculated_values.height_centile }}
                                    </div>
                                </td>
                                <td id='height_centile' style="border: 0px !important;">
                                    <i class="info green circle icon"></i>
                                </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui blue header">
                                <div class="content">
                                    Weight
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result %}
                            {% if measurement.child_measurement_value.weight is number %}
                                <td>
                                    {{ measurement.child_measurement_value.weight }} kg
                                </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    SDS
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result %}
                            {% if measurement.measurement_calculated_values.weight_sds is number %}
                                <td>
                                    <div class="ui blue header">
                                        {{ measurement.measurement_calculated_values.weight_sds }}
                                    </div>
                                </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    Centile
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result  %}
                            {% if measurement.measurement_calculated_values.weight_centile is number %}
                                <td>
                                    <div class="ui blue header">
                                        {{ measurement.measurement_calculated_values.weight_centile }}
                                    </div>
                                </td>
                                <td id='weight_centile' style=" border: 0px !important;">
                                    <i class="info green circle icon"></i>
                                </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui blue header">
                                <div class="content">
                                    BMI
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result  %}
                            {% if measurement.child_measurement_value.bmi is number %}
                                <td>
                                    {{ measurement.child_measurement_value.bmi }} kg/m2
                                </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    SDS
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result %}
                                {% if measurement.measurement_calculated_values.bmi_sds is number %}
                                    <td>
                                        <div class="ui blue header">
                                            {{ measurement.measurement_calculated_values.bmi_sds }}
                                        </div>
                                    </td>
                                {% endif %}
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    Centile
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result %}
                                {% if measurement.measurement_calculated_values.bmi_centile is number %}
                                    <td>
                                        <div class="ui blue header">
                                            {{ measurement.measurement_calculated_values.bmi_centile }}
                                        </div>
                                    </td>
                                {% endif %}
                            {% endfor %}
                            <td id='bmi_centile' style=" border: 0px !important;">
                                <i class="info green circle icon"></i>
                            </td>
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui blue header">
                                <div class="content">
                                    Head Circumference
                                    <div class="sub header">
                                    </div>
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result %}
                            {% if measurement.child_measurement_value.ofc is number %}
                                <td>
                                    {{ measurement.child_measurement_value.ofc }} cm
                                </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    SDS
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result %}
                                {% if measurement.measurement_calculated_values.ofc_sds is number %}
                                    <td>
                                        <div class="ui blue header">
                                            {{ measurement.measurement_calculated_values.ofc_sds }}
                                        </div>
                                    </td>
                                {% endif %}
                            {% endfor %}
                    </tr>
                    <tr>
                        <td>
                            <h4 class="ui header">
                                <div class="content">
                                    Centile
                                </div>
                            </h4>
                        </td>
                        {% for measurement in result  %}
                            {% if measurement.measurement_calculated_values.ofc_centile is number %}
                                <td>
                                    <div class="ui blue header">
                                        {{ measurement.measurement_calculated_values.ofc_centile }}
                                    </div>
                                </td>
                                <td id='ofc_centile' style=" border: 0px !important; ">
                                    <i class="info green circle icon"></i>
                                </td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="ui container">
            <div class="ui green button" onclick="window.location.href='{{url_for('chart')}}'" type='submit'>Chart</div>
        </div>
    {% endif %}
    <script>
        $('#corrected_decimal_age').popup({
            on: 'click',
            setFluidWidth: true,
            variation: 'wide green',
            html: '<p><b>Clinician: </b>{% if result[0].measurement_dates.clinician_decimal_age_comment %}{{result[0].measurement_dates.clinician_decimal_age_comment}}</p><p><b>Parent/Carer:</b> {{result[0].measurement_dates.lay_decimal_age_comment}}{%endif%}</p>'
        });
        $('#height_centile').popup({
            on: 'click',
            setFluidWidth: true,
            variation: 'wide green',
            html: '<p><b>Clinician: </b>{% for measurement in result %}{% if measurement.measurement_calculated_values.clinician_height_comment and measurement.child_measurement_value.clinician_height_comment is not none %}{{measurement.measurement_calculated_values.clinician_height_comment}}</p><p><b>Parent/Carer:</b> {{measurement.measurement_calculated_values.lay_height_comment}}{%endif%}{%endfor%}</p>'
        });
        $('#weight_centile').popup({
            on: 'click',
            setFluidWidth: true,
            variation: 'wide green',
            html: '<p><b>Clinician: </b>{% for measurement in result %}{% if measurement.measurement_calculated_values.clinician_weight_comment and measurement.child_measurement_value.clinician_weight_comment is not none %}{{measurement.measurement_calculated_values.clinician_weight_comment}}</p><p><b>Parent/Carer:</b> {{measurement.measurement_calculated_values.lay_weight_comment}}{%endif%}{%endfor%}</p>'
        });
        $('#bmi_centile').popup({
            on: 'click',
            setFluidWidth: true,
            variation: 'wide green',
            html: '<p><b>Clinician: </b>{% for measurement in result %}{% if measurement.measurement_calculated_values.clinician_bmi_comment and measurement.child_measurement_value.clinician_bmi_comment is not none %}{{measurement.measurement_calculated_values.clinician_bmi_comment}}</p><p><b>Parent/Carer:</b> {{measurement.measurement_calculated_values.lay_bmi_comment}}{%endif%}{%endfor%}</p>'
        });
        $('#ofc_centile').popup({
            on: 'click',
            setFluidWidth: true,
            variation: 'wide green',
            html: '<p><b>Clinician: </b>{% for measurement in result %}{% if measurement.measurement_calculated_values.clinician_ofc_comment and measurement.child_measurement_value.clinician_ofc_comment is not none %}{{measurement.measurement_calculated_values.clinician_ofc_comment}}</p><p><b>Parent/Carer:</b> {{measurement.measurement_calculated_values.lay_ofc_comment}}{%endif%}{%endfor%}</p>'
        });

        function returnComment(array, measurement, clinician) {
            for(record in array) {
                console.log(record.measurement_calculated_values.clinician_bmi_comment);
                
            }
        }

    </script>
                
{% endblock %}
